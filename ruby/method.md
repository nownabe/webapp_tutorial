# メソッド
## 概要
Rubyではすべての操作をメソッドで行います。
ここではメソッドについて説明します。

## メソッドとは
Rubyでは全てのデータがオブジェクトでした。
それと同じように、Rubyではすべての操作が__メソッド__によって行われます。

メソッドはオブジェクトに定義されているもので、そのオブジェクトを操作するために使われます。

例えば、[2.4 オブジェクト](ruby/object.html)で出てきた`.class`は「オブジェクトのクラスを返す」というメソッドです。
練習問題で出てきた`.to_s`は「オブジェクトを文字列オブジェクトに変換する」メソッドです。

## メソッドの呼び出し
メソッドを使うことを、「メソッドの呼び出し」といいます。

メソッドは次のようにして呼び出します。

```ruby
オブジェクト.メソッド名(引数1, 引数2, ..., 引数n)
```

先頭にオブジェクトがあり、その右に`.`(ピリオド、ドット)と呼び出すメソッド名を書きます。
メソッドに別のデータを渡すときは、括弧をつけてカンマ区切りで渡します。
このメソッドに渡すデータのことを引数といいます。
また、メソッドが呼ばれるオブジェクトのことを__レシーバ__とも言います。

例えば演習問題(1)で出てきた`File.read("sample1.txt")`だと、レシーバは`File`、メソッド名は`read`、引数は`"sample1.txt"`になります。

また、引数の括弧を省略することもできます。次の2つは同じ意味です。

```ruby
File.read("sample1.txt")
File.read "sample1.txt"
```

引数がない場合も同様です。

```ruby
"1234".to_i()
"1234".to_i
```

## レシーバの種類
レシーバには大きく分けて3つあります。

* インスタンス(普通のオブジェクト)
* クラス
* なし

それぞれについて説明します。

### インスタンスメソッド
`"Hello, world!"`という文字列オブジェクトや、`1234`のような数値オブジェクトのような普通のオブジェクトのことを__インスタンス__といいます。

インスタンスはクラスを元に生成されます。
これまでで説明した__オブジェクト__という言葉は__インスタンス__という言葉とほぼ等しいと思ってください。

`"Hello, world!"`のようなオブジェクトを__インスタンス__という言葉を使って正確に説明すると、「`"Hello, world!"`はStringクラスのインスタンス」というような言い方になります。
まあ「`"Hello, world"`の種類はStringクラス」の言葉を変えただけですね。

インスタンス(オブジェクト)をレシーバにとして呼び出すメソッドのことを__インスタンスメソッド__といいます。

例えば、次のようなものがあります。

```irb
irb(main):001:0> 1234.class
=> Fixnum
irb(main):002:0> 1234.5.to_i
=> 1234
irb(main):003:0> "dog, cat, rabbit".split(",")
=> ["dog", " cat", " rabbit"]
```

上から

* 整数値オブジェクト(Fixnumインスタンス)がレシーバの`class`メソッド
* 小数値オブジェクト(Floatインスタンス)がレシーバの`to_i`メソッド
* 文字列オブジェクト(Stringインスタンス)がレシーバの`split`メソッド

となっています。

それぞれのオブジェクトによってどのようなメソッドが使えるかは決まっています。
例えば、Fixnumインスタンスに対して`split`メソッドは使えません。

```irb
irb(main):008:0> 12345.split
NoMethodError: undefined method `split' for 12345:Fixnum
```

### クラスメソッド
インスタンスメソッドの他にクラスをレシーバとするメソッドもあります。
そのようなメソッドを__クラスメソッド__といいます。

クラスはオブジェクト(インスタンス)の種類のことでした。
そのため、クラスメソッドにはそのクラスのインスタンスを生成するようなメソッドが多いです。

例えば、次のようなものがあります。

```irb
irb(main):001:0> String.new("Hello, world!")
=> "Hello, world!"
irb(main):002:0> Time.now
=> 2015-10-14 10:58:27 +0900
irb(main):003:0> File.read("sample1.txt")
=> "# はじめての...(省略)
```

上から、

* `String`クラスの`new`メソッドで新しい文字列オブジェクトを生成
* `Time`クラスの`now`メソッドで現在時刻の時刻オブジェクトを生成
* `File`クラスの`read`メソッドでファイルの内容から文字列オブジェクトを生成

となっています。
クラスは必ず`String`や`Time`、`File`のように最初が大文字のアルファベットで始まります。

クラスメソッドもクラスによってどのようなメソッドが使えるかは決まっています。

### 関数的メソッド
Rubyではレシーバを省略できる場合もあります。
そのようなメソッドを関数的メソッドといいます。

例えば、今まで使った中だと`puts`や`print`が関数的メソッドになります。

```irb
irb(main):001:0> puts "Hello, world!"
Hello, world!
=> nil
```

この`puts`もメソッドで、実は`Kernel`という特別なクラス[^1]のクラスメソッドになっています。
このようにレシーバを省略すると`Kernel`クラスのクラスメソッドとして呼び出されます。

なので、`puts`は次のように明示的に`Kernel`クラスのクラスメソッドとして呼び出すこともできます。

```irb
irb(main):004:0> Kernel.puts "Hello, world!"
Hello, world!
=> nil
```

[^1]: `Kernel`は正確にはクラスではなく__モジュール__といいます。

## メソッドの定義
メソッドはプログラマが自分で定義することもできます。
メソッドの定義は次のようにします。

```ruby
def メソッド名(仮引数1, 仮引数2, ..., 仮引数n)
  処理
end
```

仮引数は引数を受取るための変数です。

例えば、受け取った引数に対して挨拶するメソッドを作ってみます。

```ruby
def hello(name)
  puts "Hello, " + name
end

# 使うときは普通のメソッドと同じように呼び出す
hello("Ruby")
```

このプログラムを実行すると、「Hello, Ruby」と表示されます。

## メソッドの返り値
メソッドは必ずなにか値(オブジェクト)を返します。
メソッドが返す値を__返り値__といいます。

返り値は`return`というキーワードで明示的に指定することができます。

例えば、与えられた数値を2倍した数値を返すメソッドを作ってみます。

```ruby
def double(number)
  return(number * 2)
end

puts double(10)
```

このプログラムを実行すると、「20」と表示されます。

メソッド内で`return`を使うと、その後の処理は無視されます。
例えば次のようにしても、`puts`は無視されてしまいます。

```ruby
def double(number)
  return(number * 2)
  puts "無視されます"
end
```

また、`return`を省略することもできます。
その場合、メソッド内で最後に評価した式の値がメソッドの返り値になります。

```ruby
def double(number)
  number * 2
end
```

この例だと、メソッド内で最後に評価したのが`number * 2`なので、引数を2倍した値が`double`メソッドの返り値になります。

## 練習問題
